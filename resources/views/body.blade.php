@extends('index')

@section('body')

<div class="sm:pb-12 mt-4 flex-shrink-0 flex-grow flex flex-col items-center">
	<div class="flex-grow flex items-center mt-4">
		<div>
			<div class="flex">
				<div class="w-20 sm:w-36 md:w-48 flex justify-center items-center">
					<img src="assets/img/golfgrid.png" alt="Colorado Rockies" class="dark:hidden w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
				</div><!--[-->
				<!-- <div class="flex items-center justify-center w-24 sm:w-36 md:w-48 h-16 sm:h-24 md:h-36">
					<img src="assets/img/COL.svg" alt="Colorado Rockies" class="dark:hidden w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
					<img src="assets/img/COL(1).svg" alt="Colorado Rockies" class="hidden dark:inline w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
				</div>
				<div class="flex items-center justify-center w-24 sm:w-36 md:w-48 h-16 sm:h-24 md:h-36">
					<img src="assets/img/SDP.svg" alt="San Diego Padres" class="dark:hidden w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
					<img src="assets/img/SDP(1).svg" alt="San Diego Padres" class="hidden dark:inline w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
				</div> -->
                <div class="flex items-center justify-center w-24 sm:w-36 md:w-48 h-16 sm:h-24 md:h-36"><!---->
					<div class="px-4 h-12 sm:h-20 md:h-24 text-sm sm:text-xl md:text-2xl text-center text-gray-800 dark:text-white flex items-center font-display uppercase font-bold leading-tight">
						<div>
							<div class="leading-tight">NIKE</div>
						</div>
					</div>
				</div><!--]-->
                <div class="flex items-center justify-center w-24 sm:w-36 md:w-48 h-16 sm:h-24 md:h-36"><!---->
					<div class="px-4 h-12 sm:h-20 md:h-24 text-sm sm:text-xl md:text-2xl text-center text-gray-800 dark:text-white flex items-center font-display uppercase font-bold leading-tight">
						<div>
							<div class="leading-tight">USA</div>
						</div>
					</div>
				</div><!--]-->
				<div class="flex items-center justify-center w-24 sm:w-36 md:w-48 h-16 sm:h-24 md:h-36"><!---->
					<div class="px-4 h-12 sm:h-20 md:h-24 text-sm sm:text-xl md:text-2xl text-center text-gray-800 dark:text-white flex items-center font-display uppercase font-bold leading-tight">
						<div>
							<div class="leading-tight">US OPEN</div>
						</div>
					</div>
				</div><!--]-->
				<div class="sm:w-36 md:w-48"></div>
			</div>
			<div class="flex items-center">
				<div>
                    <div class="flex items-center justify-center w-20 sm:w-36 md:w-48 h-24 sm:h-36 md:h-48">
                        <div class="px-4 h-12 sm:h-20 md:h-24 text-sm sm:text-xl md:text-2xl text-center text-gray-800 dark:text-white flex items-center font-display uppercase font-bold leading-tight">
                            <div>
                                <div class="leading-tight">Taylor</div>
                                <div class="leading-tight">Made</div>
                            </div>
                        </div>
					</div>
                    <div class="flex items-center justify-center w-20 sm:w-36 md:w-48 h-24 sm:h-36 md:h-48">
                        <div class="px-4 h-12 sm:h-20 md:h-24 text-sm sm:text-xl md:text-2xl text-center text-gray-800 dark:text-white flex items-center font-display uppercase font-bold leading-tight">
                            <div>
                                <div class="leading-tight">TifList</div>
                            </div>
                        </div>
					</div>
                    <div class="flex items-center justify-center w-20 sm:w-36 md:w-48 h-24 sm:h-36 md:h-48">
                        <div class="px-4 h-12 sm:h-20 md:h-24 text-sm sm:text-xl md:text-2xl text-center text-gray-800 dark:text-white flex items-center font-display uppercase font-bold leading-tight">
                            <div>
                                <div class="leading-tight">Master</div>
                                <div class="leading-tight">Win</div>
                            </div>
                        </div>
					</div>
                    <!--
					<div class="flex items-center justify-center w-20 sm:w-36 md:w-48 h-24 sm:h-36 md:h-48">
						<img src="assets/img/DET.svg" alt="Detroit Tigers" class="dark:hidden w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
						<img src="assets/img/DET(1).svg" alt="Detroit Tigers" class="hidden dark:inline w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
					</div>
					<div class="flex items-center justify-center w-20 sm:w-36 md:w-48 h-24 sm:h-36 md:h-48">
						<img src="assets/img/OAK.svg" alt="Oakland Athletics" class="dark:hidden w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
						<img src="assets/img/OAK(1).svg" alt="Oakland Athletics" class="hidden dark:inline w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
					</div>
					<div class="flex items-center justify-center w-20 sm:w-36 md:w-48 h-24 sm:h-36 md:h-48">
						<img src="assets/img/SFG.svg" alt="San Francisco Giants" class="dark:hidden w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
						<img src="assets/img/SFG(1).svg" alt="San Francisco Giants" class="hidden dark:inline w-16 sm:w-20 md:w-24 h-12 sm:h-20 md:h-24">
					</div>-->
				</div>
				<div class="bg-white dark:bg-gray-800 rounded-xl border dark:border-gray-950 grid grid-cols-3 overflow-hidden" id="buttonGroup"><!--[--><!--[--><!--[-->
					
					<button class="grid-button grid-button-hover grid-button-focus sm:w-36 md:w-48 sm:h-36 md:h-48">
						<img src="">
					</button>

					<button class="grid-button grid-button-hover grid-button-focus sm:w-36 md:w-48 sm:h-36 md:h-48" >
						<img src="">
					</button>

					<button class="grid-button grid-button-hover grid-button-focus sm:w-36 md:w-48 sm:h-36 md:h-48" >
						<img src="">
					</button>


					<button class="grid-button grid-button-hover grid-button-focus sm:w-36 md:w-48 sm:h-36 md:h-48" >
						<img src="">
					</button>
					
					<button class="grid-button grid-button-hover grid-button-focus sm:w-36 md:w-48 sm:h-36 md:h-48" >
						<img src="">
					</button>
					
					<button class="grid-button grid-button-hover grid-button-focus sm:w-36 md:w-48 sm:h-36 md:h-48" >
						<img src="">
					</button>


					<button class="grid-button grid-button-hover grid-button-focus sm:w-36 md:w-48 sm:h-36 md:h-48" >
						<img src="">
					</button>
					
					<button class="grid-button grid-button-hover grid-button-focus sm:w-36 md:w-48 sm:h-36 md:h-48" >
						<img src="">
					</button>
					
					<button class="grid-button grid-button-hover grid-button-focus sm:w-36 md:w-48 sm:h-36 md:h-48" >
						<img src="">
					</button>
				</div>
				<div class="sm:w-36 md:w-48 h-full flex justify-center">
					<div class="hidden sm:block">
						<div class="text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase text-center">Guesses Left </div>
						<div class="text-center text-7xl font-semibold">
							<div class="countup-wrap"><!--[--><!--]--><span id = "guessLeftCount">9</span><!--[--><!--]--></div>
						</div>
						<div class="flex justify-center mt-1">
							<button class="text-blue-600 dark:text-blue-400 underline text-xs" id="showSummaryButton">Show Summary</button>
						</div>
					</div>
				</div>
			</div>
			<div class="flex justify-center">
				<div class="mt-8 sm:hidden">
					<div class="text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase text-center">Guesses Left</div>
					<div class="text-center text-6xl sm:text-7xl font-semibold"><div class="countup-wrap"><!--[--><!--]--><span>0</span><!--[--><!--]--></div>
				</div>
				<div class="flex justify-center mt-1">
					<button class="text-blue-600 dark:text-blue-400 underline text-xs">Show Summary</button>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="modal fade in" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="relative">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="pointer-events-none absolute left-4 top-3.5 h-5 w-5 text-gray-400">
                    <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd">
                    </path>
                </svg>
                <input id="searchValue" value="" aria-expanded="true" aria-autocomplete="list" id="headlessui-combobox-input-36" role="combobox" type="text" tabindex="0" data-headlessui-state="open" class="h-12 w-full border-0 bg-transparent dark:bg-gray-700 pl-11 pr-9 text-gray-900 dark:text-white placeholder:text-gray-400 dark:placeholder:text-gray-200 focus:ring-0 sm:text-sm" placeholder="Search..." aria-controls="headlessui-combobox-options-37" aria-activedescendant="headlessui-combobox-option-38">
                <img src="assets/img/loading.gif" id="loadingImg" hidden viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="pointer-events-none absolute right-4 top-3.5 h-5 w-5 text-gray-400">
            </div>

            <ul  id="nameContainer" role="listbox" data-headlessui-state="open" class="max-h-72 scroll-py-2 overflow-y-auto text-sm text-gray-800 z-50 dark:bg-gray-700" style="margin-bottom: 0px!important;">
            </ul>
        </div>
    </div>
</div>


@include('summaryModal')

<script>

    var selectedPlayers = [];
    var selectedButtonNumber = -1;
    var queryText;
    var playerData;
    var guessesLefted = 1;

    $(".grid-button").on('click' , function() {
        console.log($(this).index());
        selectedButtonNumber = $(this).index();
        $('#searchValue').val("");
        $('#nameContainer').html("");
        if(guessesLefted > 0)
            $('#exampleModal').modal('show');
    });
    $('.js-example-basic-single').select2({
        tags:true,
        theme: "classic"
    });
    $(document).ready(function () {
        clearList();
        $("#guessLeftCount").text(guessesLefted);
        $('#showSummaryButton').attr('hidden' , true);
    });

    function clearList()
    {
        selectedPlayers = [];
        for(let i = 0 ; i < 9 ; i ++)
            selectedPlayers.push([]);
    }
</script>

<script>
    $('#searchValue').on('input' , function() {
        console.log("changed");
        $('#loadingImg').attr('hidden' , false);
        queryText = $(this).val();
        if($(this).val() != '')
        {

            $.ajax({
                type: 'POST',
                url: '/getData',
                data: {
                    '_token': $('input[name="_token"]').val(),
                    'text': $(this).val(),
                },
                success: function(res) {
                    console.log(res);
                    playerData = res;
                    
                    var appendHtml = "";

                    for( var item of res )
                    {
                        let selectedFlag = 0;
                        appendHtml += '<li class="grid-button-hover cursor-default select-none px-4 py-2 flex justify-between items-center font-medium" role="option" tabindex="-1" aria-selected="false" value="0">';
                        
                        for(let i = 0 ; i < 9 ; i++)
                            if(selectedPlayers[selectedButtonNumber][i] == item.id)
                                selectedFlag = 1;
                        if(selectedFlag == 0) appendHtml+='<div class="dark:text-white">';
                        else appendHtml+= '<div class="text-red-600 dark:text-red-400">';
                        appendHtml += item.name +'<div class="font-normal text-xs text-gray-500 dark:text-gray-400 -mt-0.5">' + item.years + '</div></div>';



                        if(selectedFlag == 0) appendHtml+='<button class="rounded-md bg-green-600 px-2.5 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-green-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600 playerOption" onclick = "playerSelected('+ item.id+ ')"> Select </button></li>';
                    }

                    
                    $('#nameContainer').html(appendHtml);

                    $('#loadingImg').attr('hidden' , true);
                }
            });
        }
        else{
          $('#nameContainer').html("");
          $('#loadingImg').attr('hidden' , true);
        }
    });
    
    function playerSelected(number)
    {
        console.log(queryText);
        selectedPlayers[selectedButtonNumber].push(number);
        let imgUrl;

        for(let player of playerData)
            if(player.id == number) imgUrl = player.imageUrl;

        $('#buttonGroup').children().get(selectedButtonNumber).children[0].setAttribute('src' , imgUrl);

        var appendHtml = "";

        for( var item of playerData )
        {
            let selectedFlag = 0;
            appendHtml += '<li class="grid-button-hover cursor-default select-none px-4 py-2 flex justify-between items-center font-medium" role="option" tabindex="-1" aria-selected="false" value="0">';
            
            for(let i = 0 ; i < 9 ; i++)
                if(selectedPlayers[selectedButtonNumber][i] == item.id)
                    selectedFlag = 1;
            if(selectedFlag == 0) appendHtml+='<div class="dark:text-white">';
            else appendHtml+= '<div class="text-red-600 dark:text-red-400">';
            appendHtml += item.name +'<div class="font-normal text-xs text-gray-500 dark:text-gray-400 -mt-0.5">' + item.years + '</div></div>';

            if(selectedFlag == 0) appendHtml+='<button class="rounded-md bg-green-600 px-2.5 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-green-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600 playerOption" onclick = "playerSelected('+ item.id +')"> Select </button></li>';
        }
        $('#nameContainer').html(appendHtml);
        
        guessesLefted--;
        console.log(guessesLefted);
        $("#guessLeftCount").text(guessesLefted);

        if(guessesLefted == 0)
        {
            $('#exampleModal').modal('hide');
            $('#showSummaryButton').attr('hidden' , false);
            $('#summaryModal').modal('show');
        }
    }

    $('#showSummaryButton').on('click' , function() {
        $('#summaryModal').modal('show');
    });

    function playerSelected(){
        $('#summaryModal').modal('hide');
    };
</script>
@csrf
@endsection